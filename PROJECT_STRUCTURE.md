# 📁 Структура проекта Chicken Bot

```
chicken_bot/
│
├── 📄 main.py                    # Точка входа - запуск бота
│
├── ⚙️  config.py                  # Конфигурация из переменных окружения
├── 🗄️  database.py                # Класс для работы с SQLite БД
├── ⌨️  keyboards.py               # Все клавиатуры бота
├── 🔄 middlewares.py             # Middleware (логирование, ошибки)
├── 📊 states.py                  # FSM состояния
│
├── 📁 handlers/                  # Обработчики команд и событий
│   ├── __init__.py              # Регистрация всех обработчиков
│   ├── start.py                 # /start, /help, отмена
│   ├── status.py                # Просмотр остатка
│   ├── batch.py                 # Создание новой партии
│   ├── take.py                  # Взятие порции
│   ├── history.py               # История операций
│   ├── admin.py                 # Админ-команды
│   └── common.py                # Общие утилиты для handlers
│
├── 📁 utils/                     # Вспомогательные утилиты
│   ├── __init__.py              
│   ├── parser.py                # Парсинг веса из текста
│   └── validators.py            # Валидация данных
│
├── 📁 data/                      # База данных (создаётся автоматически)
│   └── chicken.db               # SQLite база
│
├── 📄 requirements.txt           # Python зависимости
├── 📄 .env.example              # Пример конфигурации
├── 📄 .env                      # Ваша конфигурация (не в git!)
├── 📄 .gitignore                # Что не добавлять в git
│
├── 🐳 Dockerfile                 # Docker образ
├── 🐳 docker-compose.yml         # Docker Compose конфигурация
├── ⚙️  chicken_bot.service       # Systemd service файл
│
├── 📖 README.md                  # Основная документация
├── 📖 QUICKSTART.md              # Быстрый старт за 3 минуты
├── 📖 DEPLOY.md                  # Инструкции по развёртыванию
├── 📖 IMPROVEMENTS.md            # Список всех улучшений
│
└── 🧪 test_bot.py                # Юнит-тесты


═══════════════════════════════════════════════════════════

🔥 КЛЮЧЕВЫЕ ФАЙЛЫ ДЛЯ НАЧАЛА:

1. QUICKSTART.md     - Начни отсюда! Запуск за 3 минуты
2. .env.example      - Скопируй в .env и добавь токен
3. main.py           - Запусти этот файл
4. README.md         - Полная документация

═══════════════════════════════════════════════════════════

📦 ЗАВИСИМОСТИ:

• aiogram 3.15.0     - Telegram Bot фреймворк
• aiosqlite 0.20.0   - Асинхронная SQLite
• python-dotenv      - Загрузка .env файлов

═══════════════════════════════════════════════════════════

🎯 ОСНОВНЫЕ КОМПОНЕНТЫ:

┌─────────────────────────────────────────────────┐
│  main.py                                        │
│  ├─ Создаёт Bot и Dispatcher                   │
│  ├─ Регистрирует middleware                    │
│  ├─ Регистрирует handlers                      │
│  └─ Запускает polling                          │
└─────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────┐
│  config.py                                      │
│  └─ Config.from_env()                          │
│     ├─ BOT_TOKEN                               │
│     ├─ DB_PATH                                 │
│     ├─ ADMIN_IDS                               │
│     └─ другие настройки...                     │
└─────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────┐
│  database.py                                    │
│  └─ Database                                   │
│     ├─ init()           - Создание таблиц      │
│     ├─ create_batch()   - Новая партия         │
│     ├─ take_portion()   - Взять порцию         │
│     ├─ get_batch()      - Получить партию      │
│     └─ get_history()    - История операций     │
└─────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────┐
│  handlers/                                      │
│  ├─ start.py     - /start, помощь              │
│  ├─ batch.py     - Создание партии             │
│  ├─ take.py      - Взятие порции               │
│  ├─ status.py    - Просмотр остатка            │
│  ├─ history.py   - История                     │
│  └─ admin.py     - Админ-панель                │
└─────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────┐
│  utils/                                         │
│  ├─ parser.py                                  │
│  │  └─ WeightParser.parse()                   │
│  │     "1500" → 1500.0                         │
│  │     "1.5кг" → 1500.0                        │
│  │     "полкило" → 500.0                       │
│  │                                             │
│  └─ validators.py                              │
│     └─ WeightValidator.validate()             │
│        ✓ Проверка диапазона                   │
│        ✓ Проверка коэффициента                │
└─────────────────────────────────────────────────┘

═══════════════════════════════════════════════════════════

🗄️  БАЗА ДАННЫХ (SQLite):

┌─────────────────────────────────────────────────┐
│  batch                                          │
│  ├─ id              - Всегда 1                 │
│  ├─ raw_total       - Было сырой               │
│  ├─ raw_left        - Осталось сырой           │
│  ├─ cooked_total    - Было готовой             │
│  ├─ coef            - Коэффициент               │
│  └─ created         - Дата создания            │
└─────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────┐
│  history                                        │
│  ├─ id              - Автоинкремент            │
│  ├─ action_type     - Тип (new_batch/take)     │
│  ├─ text            - Описание                 │
│  └─ created         - Дата и время             │
└─────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────┐
│  messages                                       │
│  ├─ id              - Автоинкремент            │
│  ├─ msg_id          - ID сообщения Telegram    │
│  ├─ chat_id         - ID чата                  │
│  └─ created         - Дата и время             │
└─────────────────────────────────────────────────┘

═══════════════════════════════════════════════════════════

🔄 ПОТОК ДАННЫХ:

Пользователь → Message → Middleware → Handler → Database
                  ↓          ↓           ↓          ↓
              Логи    Обработка   Валидация   Сохранение
                                     ↓
                                  Ответ → Пользователь

═══════════════════════════════════════════════════════════

⚡ БЫСТРЫЕ КОМАНДЫ:

Запуск:
  python main.py                    # Обычный запуск
  docker-compose up -d              # Docker
  
Тесты:
  python test_bot.py                # Запуск тестов
  
Логи:
  docker-compose logs -f            # Docker логи
  journalctl -u chicken_bot -f      # Systemd логи

Остановка:
  Ctrl+C                            # Обычный
  docker-compose down               # Docker
  systemctl stop chicken_bot        # Systemd

═══════════════════════════════════════════════════════════
```
